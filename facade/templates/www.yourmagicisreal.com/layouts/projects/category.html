<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>{{ category.title }}</title>
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link rel="icon" type="image/png" href="/static/img/favicon.ico" />

  <link rel="stylesheet" href="/static/css/normalize.css">
  <link rel="stylesheet" href="/static/css/fonts.css">
  <link rel="stylesheet" href="/static/css/sitewide.css">


  <script type="text/javascript" src="/static/js/jquery.min.js"></script>
  <script type="text/javascript" src="/static/js/underscore-min.1.5.2.js"></script>
  <script type="text/javascript" src="/static/js/title_slide.js"></script>


  <script type='text/javascript'>

    var columns = (function(){
      var top = 5;
      var left = 40;
      var right = 20;
      var column = 40;

      function init(){
        this.add_dragger();
        this.add_sizer();
        this.draw_column();
      }

      init.prototype.draw_column = function(){
        $('.projects .column1').css({
          'width':column+'%',
          'margin': top + '%' + right + '%' + top + '%' + left + '%'
        });
      }

      init.prototype.move_column = function(l){
        left = l;
        right = 100 - (left + column);
        this.draw_column();
      }

      init.prototype.size_column = function(r){
        column = (r - left)
        right = 100 - (left + column);
        this.draw_column();
      }

      init.prototype.add_dragger = function(){
        var dragger = $('<a class="dragger phil_box"></a>').appendTo($('.projects .column1'))
        var t = this;
        dragger.mousedown(function(e){
          var w = $(document).width();
          var o = -e.offsetX;

          $(document).mousemove(function(e){
            l = e.pageX + o;
            t.move_column((l/w)*100);
            dragger.html('<b class="label_above">'+Math.ceil((l/w)*100)+'%</b>')
          })

          $(document).mouseup(function(e){
            dragger.html('');
            $(document).unbind('mousemove');
            $(document).unbind('mouseup');
          })
          return false;
        })
      }

      init.prototype.add_sizer = function(){
        var sizer = $('<a class="sizer phil_box"></a>').appendTo($('.projects .column1'))
        var t = this;
        sizer.mousedown(function(e){

          var w = $(document).width();
          var o = -e.offsetX + sizer.width();

          $(document).mousemove(function(e){
            r = e.pageX + o;
            t.size_column((r/w)*100);
            sizer.html('<b class="label_above">'+Math.ceil((r/w)*100)+'%</b>')
          })

          $(document).mouseup(function(e){
            sizer.html('');
            $(document).unbind('mousemove');
            $(document).unbind('mouseup');
          })

          return false;
        })
      }

      init.prototype.add_hider = function(){
        var sizer = $('<a class="hider hide_box"></a>').appendTo($('body'))
        sizer.click(function(e){
          $('.phil_box').fadeToggle();
          $(this).show();
          return false;
        })
      }

      return new init();
    })

    var imgClickClass = (function(selector){
      var baseCss = {}

      function init(selector){
        $(selector).on('click', console.log);
      }

      init.prototype.show = function(img){

      }

      init.prototype.hide = function(img){

      }

      return new init(selector);
    })

    $(document).ready(function(){

      columns();
      imgClickClass('.project img');

    })



  </script>

  <style type="text/css">
  </style>



</head>
<body class='projects'>



  <div class='page'>

    <div id='nav'>
      <a href='/category/simulacra'>Simulacra</a>
      <a>Projects</a>
      <a href='aaxxx3.html'>AA&nbsp;XXX</a>
    </div>


    <div class='title'><h1>{{ category.title }}</h1></div>


    <div class='column2 subnav'>
    {% for project in category %}
      {% if project.succset|length > 1 %}
        {% set class = ['left', 'right'] | random() | string() %}
        <a class='{{class}} show' rel='link_{{project.id}}'>{{project.title}}</a>
      {% endif %}
    {% endfor %}
    </div>

    <div class='column1'>

      {% for project in category.succset %}
        {% if project.description %}

        <div id='display_{{project.id}}' class='project_block high openable'>
          <div class='project'>
            {% for media in project.succset %}
            <img src='{{media.href}}' alt='' />
            {% endfor %}

            {% if project.title %}
              <h2>{{project.title}}</h2>
            {% endif %}

            {% if project.description %}
              <div class='description'>{{project.description|nl2br|safe}}</div>
            {% endif %}


          </div>
        </div>


        {% elif project.succset %}

        <div class='project_block low'>
          <a class=''>
            <img src='{{project.succset[0].href}}' alt='' />
          </a>
        </div>

        {% endif %}


      {% endfor %}



    </div>
  </div>

</body>
</html>
