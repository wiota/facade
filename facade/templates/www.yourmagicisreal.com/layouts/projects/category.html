<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>{{ category.title }}</title>
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link rel="icon" type="image/png" href="/static/img/favicon.ico" />

  <link rel="stylesheet" href="/static/css/normalize.css">
  <link rel="stylesheet" href="/static/css/fonts.css">
  <link rel="stylesheet" href="/static/css/sitewide.css">


  <script type="text/javascript" src="/static/js/jquery.min.js"></script>
  <script type="text/javascript" src="/static/js/underscore-min.1.5.2.js"></script>
  <script type="text/javascript" src="/static/js/title_slide.js"></script>


  <script type='text/javascript'>

    var columns = (function(){

      // Private
      // get these from original css
      var top = 5;
      var left = 40;
      var right = 20;
      var column = 40;

      var draw_column = function(){
        $('.projects .column1').css({
          'width':column+'%',
          'margin': top + '%' + right + '%' + top + '%' + left + '%'
        });
      }

      var move_column = function(l){
        left = l;
        right = 100 - (left + column);
        draw_column();
      }

      var size_column_left = function(l){
        left = l;
        column = 100 - (left + right);
        draw_column();
      }

      var size_column = function(r){
        column = (r - left)
        right = 100 - (left + column);
        draw_column();
      }

      var add_pill_el = function(cls, place){
        return dragger = $('<a class="'+cls+' phil_box"></a>').appendTo($(place))
      }

      var add_pill = function(side, cls, column, fn){
        var pill = add_pill_el(cls, column);
        pill.mousedown(function(e){

          if(e.which!=1){
            // if not primary mouse button
            return true;
          }

          // what is difference between where we clicked in the element
          // and the center of the element
          var w = $(document).width();
          var elClick = e.offsetX;
          var elPos = $(e.target).position().left;
          var elWid = $(column).width();

          if(side=='left'){
            var o = elClick+elPos
          } else if (side=='right'){
            var o = elClick+elPos-elWid;
          }

          $(document).mousemove(function(e){
            l = e.pageX - o;
            var amnt = (l/w)*100;
            fn(amnt);
            pill.html('<b class="label_above no_select">'+Math.ceil(amnt)+'%</b>')
          })

          $(document).mouseup(function(e){
            pill.html('');
            $(document).unbind('mousemove');
            $(document).unbind('mouseup');
          })
          return false;
        })
      }

      // Public

      function init(){
        //this.add_dragger();
        //this.add_sizer();
        add_pill('left','dragger', '.projects .column1', size_column_left);
        add_pill('right','sizer', '.projects .column1', size_column);
        draw_column();
      }


      init.prototype.add_hider = function(){
        var sizer = $('<a class="hider hide_box"></a>').appendTo($('body'))
        sizer.click(function(e){
          $('.phil_box').fadeToggle();
          $(this).show();
          return false;
        })
      }

      return new init();
    })

    var imgClickClass = (function(selector){
      var baseCss = {};
      var $images = null;

      function init(selector){
        var t = this;
        $images = $(selector).on("click", function(){
          t.toggleShow($(this));
        });
      }

      init.prototype.toggleShow = function(img){
        img.toggleClass('show');
      }

      return new init(selector);
    })

    $(document).ready(function(){
      columns();
      imgClickClass('.project img');
    })



  </script>

  <style type="text/css">
  </style>



</head>
<body class='projects'>



  <div class='page'>

    <div id='nav'>
      <a href='/category/simulacra'>Simulacra</a>
      <a>Projects</a>
      <a href='aaxxx3.html'>AA&nbsp;XXX</a>
    </div>


    <div class='title'><h1>{{ category.title }}</h1></div>


    <div class='column2 subnav'>
    {% for project in category %}
      {% if project.succset|length > 1 %}
        {% set class = ['left', 'right'] | random() | string() %}
        <a class='{{class}} show' rel='link_{{project.id}}'>{{project.title}}</a>
      {% endif %}
    {% endfor %}
    </div>

    <div class='column1'>

      {% for project in category.succset %}
        {% if project.description %}

        <div id='display_{{project.id}}' class='project_block high openable'>
          <div class='project'>
            {% for media in project.succset %}
            <img src='{{media.href}}' alt='' />
            {% endfor %}

            {% if project.title %}
              <h2>{{project.title}}</h2>
            {% endif %}

            {% if project.description %}
              <div class='description'>{{project.description|nl2br|safe}}</div>
            {% endif %}


          </div>
        </div>


        {% elif project.succset %}

        <div class='project_block low'>
          <a class=''>
            <img src='{{project.succset[0].href}}' alt='' />
          </a>
        </div>

        {% endif %}


      {% endfor %}



    </div>
  </div>

</body>
</html>
